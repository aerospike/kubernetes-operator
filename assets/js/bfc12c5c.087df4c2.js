"use strict";(self.webpackChunkwebsite_operator=self.webpackChunkwebsite_operator||[]).push([[2156],{9614:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return i},metadata:function(){return p},toc:function(){return c},default:function(){return m}});var r=n(3117),a=n(102),o=(n(7294),n(3905)),l=["components"],s={title:"Install the Operator On Kubernetes",description:"Install The Operator On Kubernetes"},i=void 0,p={unversionedId:"Install-the-Operator-on-Kubernetes",id:"Install-the-Operator-on-Kubernetes",isDocsHomePage:!1,title:"Install the Operator On Kubernetes",description:"Install The Operator On Kubernetes",source:"@site/docs/Install-the-Operator-on-Kubernetes.md",sourceDirName:".",slug:"/Install-the-Operator-on-Kubernetes",permalink:"/kubernetes-operator/next/Install-the-Operator-on-Kubernetes",editUrl:"https://github.com/aerospike/kubernetes-operator/edit/main/docs/Install-the-Operator-on-Kubernetes.md",tags:[],version:"current",frontMatter:{title:"Install the Operator On Kubernetes",description:"Install The Operator On Kubernetes"},sidebar:"docsSidebar",previous:{title:"System Requirements",permalink:"/kubernetes-operator/next/System-Requirements"},next:{title:"Create Aerospike Cluster",permalink:"/kubernetes-operator/next/Create-Aerospike-cluster"}},c=[{value:"Install the Operator Lifecycle Manager (OLM)",id:"install-the-operator-lifecycle-manager-olm",children:[],level:2},{value:"Use OLM to Install the Aerospike Kubernetes Operator",id:"use-olm-to-install-the-aerospike-kubernetes-operator",children:[{value:"Manage a Single Namespace (Default)",id:"manage-a-single-namespace-default",children:[],level:3},{value:"Manage Multiple Specific Namespaces",id:"manage-multiple-specific-namespaces",children:[],level:3},{value:"Manage All Namespaces",id:"manage-all-namespaces",children:[],level:3}],level:2},{value:"RBAC",id:"rbac",children:[],level:2},{value:"Verify the Operator is Running",id:"verify-the-operator-is-running",children:[],level:2},{value:"Check Operator Logs",id:"check-operator-logs",children:[],level:2}],u={toc:c};function m(e){var t=e.components,n=(0,a.Z)(e,l);return(0,o.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"To begin, create a new Kubernetes cluster on the platform of your choice, and configure kubectl to use that cluster."),(0,o.kt)("h2",{id:"install-the-operator-lifecycle-manager-olm"},"Install the Operator Lifecycle Manager (OLM)"),(0,o.kt)("p",null,"We recommend using ",(0,o.kt)("a",{parentName:"p",href:"https://olm.operatorframework.io/%5D"},"Operator Lifecycle Manager (OLM)")," to run and manage the Aerospike Kubernetes Operator in production environments. OLM is the preferred way to manage Kubernetes operators in production."),(0,o.kt)("p",null,"Install OLM on your Kubernetes cluster with the command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"operator-sdk olm install\n")),(0,o.kt)("h2",{id:"use-olm-to-install-the-aerospike-kubernetes-operator"},"Use OLM to Install the Aerospike Kubernetes Operator"),(0,o.kt)("p",null,"Create the ",(0,o.kt)("inlineCode",{parentName:"p"},"aerospike")," namespace:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl create namespace aerospike\n")),(0,o.kt)("p",null,"Next, choose the scope of your Operator installation."),(0,o.kt)("p",null,"You will always install the Operator on a single namespace. However, the Operator can deploy and manage Aerospike clusters in multiple namespaces using the ",(0,o.kt)("inlineCode",{parentName:"p"},"MultiNamespace")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"AllNamespaces")," install modes."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"A single namespace (default)"),(0,o.kt)("li",{parentName:"ul"},"Multiple namespaces (",(0,o.kt)("inlineCode",{parentName:"li"},"--install-mode MultiNamespace"),")"),(0,o.kt)("li",{parentName:"ul"},"All available namespaces (",(0,o.kt)("inlineCode",{parentName:"li"},"--install-mode AllNamespaces"),")")),(0,o.kt)("h3",{id:"manage-a-single-namespace-default"},"Manage a Single Namespace (Default)"),(0,o.kt)("p",null,"To install the Operator on the ",(0,o.kt)("inlineCode",{parentName:"p"},"aerospike")," namespace, and only use it to manage the ",(0,o.kt)("inlineCode",{parentName:"p"},"aerospike")," namespace, run the Operator bundle with the command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"operator-sdk run bundle docker.io/aerospike/aerospike-kubernetes-operator-bundle:2.0.0-rc1 --namespace=aerospike\n")),(0,o.kt)("h3",{id:"manage-multiple-specific-namespaces"},"Manage Multiple Specific Namespaces"),(0,o.kt)("p",null,"Use ",(0,o.kt)("inlineCode",{parentName:"p"},"--install-mode MultiNamespace=[namespace 1],[namespace 1],[etc]")," to manage Aerospike clusters on multiple specific namespaces. Specify the namespaces in a comma-separated list (no spaces)."),(0,o.kt)("p",null,"For example, to install the Operator on the ",(0,o.kt)("inlineCode",{parentName:"p"},"aerospike")," namespace and use it to manage Aerospike clusters on the ",(0,o.kt)("inlineCode",{parentName:"p"},"ns1")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"ns2")," namespaces, the command is:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"operator-sdk run bundle docker.io/aerospike/aerospike-kubernetes-operator-bundle:2.0.0-rc1 --namespace=aerospike --install-mode MultiNamespace=ns1,ns2\n")),(0,o.kt)("h3",{id:"manage-all-namespaces"},"Manage All Namespaces"),(0,o.kt)("p",null,"Use ",(0,o.kt)("inlineCode",{parentName:"p"},"--install-mode AllNamespaces")," to manage Aerospike clusters on all available namespaces:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"operator-sdk run bundle docker.io/aerospike/aerospike-kubernetes-operator-bundle:2.0.0-rc1 --namespace=aerospike --install-mode AllNamespaces\n")),(0,o.kt)("h2",{id:"rbac"},"RBAC"),(0,o.kt)("p",null,"For information on working with RBAC on multiple clusters, see ",(0,o.kt)("a",{parentName:"p",href:"/kubernetes-operator/next/Multiple-Aerospike-clusters#rbac-for-other-namespaces"},"RBAC for other namespace"),"."),(0,o.kt)("h2",{id:"verify-the-operator-is-running"},"Verify the Operator is Running"),(0,o.kt)("p",null,"Use ",(0,o.kt)("inlineCode",{parentName:"p"},"kubectl get csv -n aerospike")," to verify the Operator's CSV is in the ",(0,o.kt)("inlineCode",{parentName:"p"},"Succeeded")," phase."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl get csv -n aerospike\n\nNAME                                       DISPLAY                         VERSION     REPLACES   PHASE\naerospike-kubernetes-operator.v2.0.0-rc1   Aerospike Kubernetes operator   2.0.0-rc1              Succeeded\n\n")),(0,o.kt)("p",null,"Next, use ",(0,o.kt)("inlineCode",{parentName:"p"},"kubectl get pod -n aerospike")," to verify the Operator's pod is running."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl get pod -n aerospike\n\nNAME                                                              READY   STATUS      RESTARTS   AGE\n5af02cb7676a864fa68cc875fb1bc64df2f1223ab355b4911792e9--1-vlltn   0/1     Completed   0          63s\naerospike-operator-controller-manager-55d45754bf-smzxc            2/2     Running     0          48s\nker-io-aerospike-aerospike-kubernetes-operator-bundle-2-0-0-rc1   1/1     Running     0          73s\n\n")),(0,o.kt)("h2",{id:"check-operator-logs"},"Check Operator Logs"),(0,o.kt)("p",null,"If you need to view the Operator logs for any reason, use ",(0,o.kt)("inlineCode",{parentName:"p"},"kubectl -n aerospike logs -f [manager pod name] -c manager")," to show the logs on your manager pod. To find the manager pod name, use ",(0,o.kt)("inlineCode",{parentName:"p"},"kubectl get pod -n aerospike")," as shown above."),(0,o.kt)("p",null,"For example, the name of the manager pod in the previous example is ",(0,o.kt)("inlineCode",{parentName:"p"},"aerospike-operator-controller-manager-55d45754bf-smzxc"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'\n$ kubectl -n aerospike logs -f aerospike-operator-controller-manager-55d45754bf-smzxc -c manager\n\n2021-10-15T19:09:58.058Z    INFO    controller-runtime.metrics  metrics server is starting to listen    {"addr": "127.0.0.1:8080"}\n2021-10-15T19:09:58.062Z    INFO    setup   Init aerospike-server config schemas\n\n2021-10-15T19:09:58.071Z    DEBUG   schema-map  Config schema added {"version": "4.7.0"}\n2021-10-15T19:09:58.072Z    INFO    aerospikecluster-resource   Registering mutating webhook to the webhook server\n2021-10-15T19:09:58.073Z    INFO    controller-runtime.webhook  registering webhook {"path": "/mutate-asdb-aerospike-com-v1beta1-aerospikecluster"}\n2021-10-15T19:09:58.073Z    INFO    controller-runtime.builder  skip registering a mutating webhook, admission.Defaulter interface is not implemented   {"GVK": "asdb.aerospike.com/v1beta1, Kind=AerospikeCluster"}\n2021-10-15T19:09:58.073Z    INFO    controller-runtime.builder  Registering a validating webhook    {"GVK": "asdb.aerospike.com/v1beta1, Kind=AerospikeCluster", "path": "/validate-asdb-aerospike-com-v1beta1-aerospikecluster"}\n2021-10-15T19:09:58.073Z    INFO    controller-runtime.webhook  registering webhook {"path": "/validate-asdb-aerospike-com-v1beta1-aerospikecluster"}\n2021-10-15T19:09:58.074Z    INFO    setup   Starting manager\nI1015 19:09:58.074722       1 leaderelection.go:243] attempting to acquire leader lease aerospike/96242fdf.aerospike.com...\n\n\n')))}m.isMDXComponent=!0},3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return k}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=r.createContext({}),p=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(i.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=p(n),k=a,d=m["".concat(i,".").concat(k)]||m[k]||u[k]||o;return n?r.createElement(d,l(l({ref:t},c),{},{components:n})):r.createElement(d,l({ref:t},c))}));function k(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:a,l[1]=s;for(var p=2;p<o;p++)l[p]=n[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);