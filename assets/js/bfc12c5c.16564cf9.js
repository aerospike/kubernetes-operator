"use strict";(self.webpackChunkwebsite_operator=self.webpackChunkwebsite_operator||[]).push([[2156],{3905:function(e,t,a){a.d(t,{Zo:function(){return c},kt:function(){return d}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=n.createContext({}),p=function(e){var t=n.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(i.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=p(a),d=r,k=m["".concat(i,".").concat(d)]||m[d]||u[d]||o;return a?n.createElement(k,s(s({ref:t},c),{},{components:a})):n.createElement(k,s({ref:t},c))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,s=new Array(o);s[0]=m;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l.mdxType="string"==typeof e?e:r,s[1]=l;for(var p=2;p<o;p++)s[p]=a[p];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},2507:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return l},contentTitle:function(){return i},metadata:function(){return p},toc:function(){return c},default:function(){return m}});var n=a(7462),r=a(3366),o=(a(7294),a(3905)),s=["components"],l={title:"Install the Operator Using OLM",description:"How to install the Aerospike Kubernetes Operator using Operator Lifecycle Management (OLM)",id:"install-operator-olm"},i=void 0,p={unversionedId:"install-operator-olm",id:"install-operator-olm",title:"Install the Operator Using OLM",description:"How to install the Aerospike Kubernetes Operator using Operator Lifecycle Management (OLM)",source:"@site/docs/Install-the-Operator-on-Kubernetes.md",sourceDirName:".",slug:"/install-operator-olm",permalink:"/kubernetes-operator/next/install-operator-olm",editUrl:"https://github.com/aerospike/kubernetes-operator/edit/main/docs/Install-the-Operator-on-Kubernetes.md",tags:[],version:"current",frontMatter:{title:"Install the Operator Using OLM",description:"How to install the Aerospike Kubernetes Operator using Operator Lifecycle Management (OLM)",id:"install-operator-olm"},sidebar:"docsSidebar",previous:{title:"System Requirements",permalink:"/kubernetes-operator/next/System-Requirements"},next:{title:"Install the Operator Using Helm",permalink:"/kubernetes-operator/next/install-operator-helm"}},c=[{value:"Operator Overview",id:"operator-overview",children:[],level:2},{value:"Install the Operator Lifecycle Manager (OLM)",id:"install-the-operator-lifecycle-manager-olm",children:[],level:2},{value:"Use OLM to Install the Aerospike Kubernetes Operator",id:"use-olm-to-install-the-aerospike-kubernetes-operator",children:[{value:"Manage a Single Namespace (Default)",id:"manage-a-single-namespace-default",children:[],level:3},{value:"Manage Multiple Specific Namespaces",id:"manage-multiple-specific-namespaces",children:[],level:3},{value:"Manage All Namespaces",id:"manage-all-namespaces",children:[],level:3}],level:2},{value:"RBAC",id:"rbac",children:[],level:2},{value:"Verify the Operator is Running",id:"verify-the-operator-is-running",children:[],level:2},{value:"Check Operator Logs",id:"check-operator-logs",children:[],level:2}],u={toc:c};function m(e){var t=e.components,a=(0,r.Z)(e,s);return(0,o.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"To begin, create a new Kubernetes cluster on the platform of your choice, and configure kubectl to use that cluster. See the ",(0,o.kt)("a",{parentName:"p",href:"/kubernetes-operator/next/System-Requirements"},"Requirements page")," for Kubernetes version and other requirements."),(0,o.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"If you plan to use Helm charts to deploy Aerospike clusters, you also need to ",(0,o.kt)("a",{parentName:"p",href:"/kubernetes-operator/next/install-operator-helm"},"use Helm to install the Operator"),", not OLM."))),(0,o.kt)("h2",{id:"operator-overview"},"Operator Overview"),(0,o.kt)("p",null,"The Aerospike Kubernetes Operator makes it easier for you to use Aerospike Enterprise clusters on Kubernetes. Instead of making changes to the cluster by hand, you specify changes in the Aerospike cluster CR file and use ",(0,o.kt)("inlineCode",{parentName:"p"},"kubectl apply")," to apply these changes. The Operator picks up on the changes and does what it needs to do in order to make them happen."),(0,o.kt)("p",null,"For example, to add Rack Awareness to your Aerospike cluster, add a rack-aware section to the CR as described in ",(0,o.kt)("a",{parentName:"p",href:"/kubernetes-operator/next/Rack-Awareness"},"Rack Awareness"),". Use ",(0,o.kt)("inlineCode",{parentName:"p"},"kubectl apply -f")," to apply the CR, and the Operator deploys Rack Awareness as specified."),(0,o.kt)("p",null,"This documentation includes examples of various Aerospike configuration settings and possibilities you can use with your Aerospike cluster on Kubernetes. If you have questions, suggestions, or other feedback, please let us know."),(0,o.kt)("h2",{id:"install-the-operator-lifecycle-manager-olm"},"Install the Operator Lifecycle Manager (OLM)"),(0,o.kt)("p",null,"We recommend using ",(0,o.kt)("a",{parentName:"p",href:"https://olm.operatorframework.io/%5D"},"Operator Lifecycle Manager (OLM)")," to run and manage the Aerospike Kubernetes Operator in production environments. OLM is the preferred way to manage Kubernetes operators in production."),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"If you are deploying on OpenShift/OKD, you can skip this step. OLM is pre-installed on OpenShift."))),(0,o.kt)("p",null,"Install OLM on your Kubernetes cluster with the command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"operator-sdk olm install\n")),(0,o.kt)("h2",{id:"use-olm-to-install-the-aerospike-kubernetes-operator"},"Use OLM to Install the Aerospike Kubernetes Operator"),(0,o.kt)("p",null,"Create the ",(0,o.kt)("inlineCode",{parentName:"p"},"aerospike")," namespace:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl create namespace aerospike\n")),(0,o.kt)("p",null,"Next, choose the scope of your Operator installation."),(0,o.kt)("p",null,"You will always install the Operator on a single namespace. However, the Operator can deploy and manage Aerospike clusters in multiple namespaces using the ",(0,o.kt)("inlineCode",{parentName:"p"},"MultiNamespace")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"AllNamespaces")," install modes."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"A single namespace (default)"),(0,o.kt)("li",{parentName:"ul"},"Multiple namespaces (",(0,o.kt)("inlineCode",{parentName:"li"},"--install-mode MultiNamespace"),")"),(0,o.kt)("li",{parentName:"ul"},"All available namespaces (",(0,o.kt)("inlineCode",{parentName:"li"},"--install-mode AllNamespaces"),")")),(0,o.kt)("h3",{id:"manage-a-single-namespace-default"},"Manage a Single Namespace (Default)"),(0,o.kt)("p",null,"To install the Operator on the ",(0,o.kt)("inlineCode",{parentName:"p"},"aerospike")," namespace, and only use it to manage the ",(0,o.kt)("inlineCode",{parentName:"p"},"aerospike")," namespace, run the Operator bundle with the command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"operator-sdk run bundle docker.io/aerospike/aerospike-kubernetes-operator-bundle:2.0.0-rc2 --namespace=aerospike\n")),(0,o.kt)("h3",{id:"manage-multiple-specific-namespaces"},"Manage Multiple Specific Namespaces"),(0,o.kt)("p",null,"Use ",(0,o.kt)("inlineCode",{parentName:"p"},"--install-mode MultiNamespace=[namespace 1],[namespace 1],[etc]")," to manage Aerospike clusters on multiple specific namespaces. Specify the namespaces in a comma-separated list (no spaces)."),(0,o.kt)("p",null,"For example, to install the Operator on the ",(0,o.kt)("inlineCode",{parentName:"p"},"aerospike")," namespace and use it to manage Aerospike clusters on the ",(0,o.kt)("inlineCode",{parentName:"p"},"ns1")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"ns2")," namespaces, the command is:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"operator-sdk run bundle docker.io/aerospike/aerospike-kubernetes-operator-bundle:2.0.0-rc2 --namespace=aerospike --install-mode MultiNamespace=ns1,ns2\n")),(0,o.kt)("h3",{id:"manage-all-namespaces"},"Manage All Namespaces"),(0,o.kt)("p",null,"Use ",(0,o.kt)("inlineCode",{parentName:"p"},"--install-mode AllNamespaces")," to manage Aerospike clusters on all available namespaces:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"operator-sdk run bundle docker.io/aerospike/aerospike-kubernetes-operator-bundle:2.0.0-rc2 --namespace=aerospike --install-mode AllNamespaces\n")),(0,o.kt)("h2",{id:"rbac"},"RBAC"),(0,o.kt)("p",null,"For information on working with RBAC on multiple clusters, see ",(0,o.kt)("a",{parentName:"p",href:"/kubernetes-operator/next/Multiple-Aerospike-clusters"},"RBAC for other namespace"),"."),(0,o.kt)("h2",{id:"verify-the-operator-is-running"},"Verify the Operator is Running"),(0,o.kt)("p",null,"Use ",(0,o.kt)("inlineCode",{parentName:"p"},"kubectl get csv -n aerospike")," to verify the Operator's CSV is in the ",(0,o.kt)("inlineCode",{parentName:"p"},"Succeeded")," phase."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl get csv -n aerospike\n\nNAME                                       DISPLAY                         VERSION     REPLACES   PHASE\naerospike-kubernetes-operator.v2.0.0-rc2   Aerospike Kubernetes operator   2.0.0-rc2              Succeeded\n\n")),(0,o.kt)("p",null,"Next, use ",(0,o.kt)("inlineCode",{parentName:"p"},"kubectl get pod -n aerospike")," to verify the Operator's pod is running."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl get pod -n aerospike\n\nNAME                                                              READY   STATUS      RESTARTS   AGE\n5af02cb7676a864fa68cc875fb1bc64df2f1223ab355b4911792e9--1-vlltn   0/1     Completed   0          63s\naerospike-operator-controller-manager-55d45754bf-smzxc            2/2     Running     0          48s\nker-io-aerospike-aerospike-kubernetes-operator-bundle-2-0-0-rc1   1/1     Running     0          73s\n\n")),(0,o.kt)("h2",{id:"check-operator-logs"},"Check Operator Logs"),(0,o.kt)("p",null,"If you need to view the Operator logs for any reason, use ",(0,o.kt)("inlineCode",{parentName:"p"},"kubectl -n aerospike logs -f [manager pod name] -c manager")," to show the logs on your manager pod. To find the manager pod name, use ",(0,o.kt)("inlineCode",{parentName:"p"},"kubectl get pod -n aerospike")," as shown above."),(0,o.kt)("p",null,"For example, the name of the manager pod in the previous example is ",(0,o.kt)("inlineCode",{parentName:"p"},"aerospike-operator-controller-manager-55d45754bf-smzxc"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'\n$ kubectl -n aerospike logs -f aerospike-operator-controller-manager-55d45754bf-smzxc -c manager\n\n2021-10-15T19:09:58.058Z    INFO    controller-runtime.metrics  metrics server is starting to listen    {"addr": "127.0.0.1:8080"}\n2021-10-15T19:09:58.062Z    INFO    setup   Init aerospike-server config schemas\n\n2021-10-15T19:09:58.071Z    DEBUG   schema-map  Config schema added {"version": "4.7.0"}\n2021-10-15T19:09:58.072Z    INFO    aerospikecluster-resource   Registering mutating webhook to the webhook server\n2021-10-15T19:09:58.073Z    INFO    controller-runtime.webhook  registering webhook {"path": "/mutate-asdb-aerospike-com-v1beta1-aerospikecluster"}\n2021-10-15T19:09:58.073Z    INFO    controller-runtime.builder  skip registering a mutating webhook, admission.Defaulter interface is not implemented   {"GVK": "asdb.aerospike.com/v1beta1, Kind=AerospikeCluster"}\n2021-10-15T19:09:58.073Z    INFO    controller-runtime.builder  Registering a validating webhook    {"GVK": "asdb.aerospike.com/v1beta1, Kind=AerospikeCluster", "path": "/validate-asdb-aerospike-com-v1beta1-aerospikecluster"}\n2021-10-15T19:09:58.073Z    INFO    controller-runtime.webhook  registering webhook {"path": "/validate-asdb-aerospike-com-v1beta1-aerospikecluster"}\n2021-10-15T19:09:58.074Z    INFO    setup   Starting manager\nI1015 19:09:58.074722       1 leaderelection.go:243] attempting to acquire leader lease aerospike/96242fdf.aerospike.com...\n\n\n')))}m.isMDXComponent=!0}}]);